# 6.6 Troubleshooting
## Home Work
###   ***Task 1***
+ остановка текущей операции
```bash
    db.currentOp()
    db.killOp()
```  
+ предложение по предотвращению долгих операций:
        необходимо постороить/перестроить соответствующий индекс
###   ***Task 2***
+ Возможно при добавлении очередной реплики мы превысили лимит памяти maxmemory, в таком случае Redis отвечает ошибкой записи.
+ Так же, как вариант, при дублировании данных на все реплики, их объём превышает ширину канала. Тогда могут теряться пакеты, и Redis начнёт считать, что реплик у него недостаточно и заблокирует запись.
### ***Task 3***
+ Возможной причиной может быть увеличение нагрузки на БД, сбои сети. 
+ Возможные меры решения:
   1. Увеличить значение параметров : connect_timeout, interactive_timeout, wait_timeout;
   2. Добавить ресурсов на машине;
   3. Создать индексы для оптимизации  и ускорения запросов;
   4. Увеличивать net_read_timeout;
   5. расширить максимальное число соединений (max_connections). 
### ***Task 4***
+ Необходимо настроить "перевыделение" памяти в sysctl.conf:
```
    vm.overcommit_memory = 2
    vm.overcommit_ratio (по-умолчанию 60%, если БД помещается в ОЗУ выставить 1)
```
Та же можно настроить swap: указать в параметре vm.swappiness значение побольше (по-умолчанию = 60), тобы ядро начало использовать своп раньше.
